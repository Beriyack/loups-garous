<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loups-Garous Web</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- En-tÃªte fixe pour mobile -->
<header class="sticky-top bg-dark border-bottom border-secondary mb-3 shadow-sm" style="z-index: 1020;">
    <div class="container py-2">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="h5 m-0 text-white" style="cursor: pointer;" onclick="location.reload()">ğŸº LG Web</h1>
            <div>
                <button class="btn btn-sm btn-info me-1" data-bs-toggle="modal" data-bs-target="#rulesModal">RÃ¨gles</button>
            </div>
        </div>
        <div id="phaseDisplay" class="alert alert-warning text-center m-0 mt-2 py-1 small">
            En attente... <span id="timerDisplay" class="badge bg-dark ms-2">--:--</span>
        </div>
    </div>
</header>

<main class="container pb-5">
    <!-- =================================================================== -->
    <!-- Zone de Connexion -->
    <!-- =================================================================== -->
    <div id="loginArea" class="row justify-content-center">
        <div class="col-md-6">
            <div class="card p-4 shadow">
                <div class="mb-3">
                    <label for="username" class="form-label">Votre Pseudo</label>
                    <input type="text" class="form-control" id="username" placeholder="Entrez votre nom">
                </div>
                
                <hr>
                <div class="d-grid gap-2">
                    <button id="btnCreatePrivate" class="btn btn-primary">CrÃ©er une partie privÃ©e</button>
                    <div class="input-group">
                        <input type="text" id="roomIdInput" class="form-control" placeholder="Code de la partie (ex: X7K9P)">
                        <button id="btnJoinPrivate" class="btn btn-outline-primary">Rejoindre</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- =================================================================== -->
    <!-- Zone de Lobby -->
    <!-- =================================================================== -->
    <div id="lobbyArea" class="row justify-content-center d-none">
        <div class="col-md-8 text-center">
            <div class="alert alert-info">
                Salle : <strong id="displayRoomId">...</strong>
                <button id="btnCopyLink" class="btn btn-outline-secondary btn-sm ms-2">Copier le lien</button>
                | En attente des joueurs...
            </div>
            <div class="row align-items-center">
                <div class="col-md-8">
                    <ul id="playerList" class="list-group mb-3 text-dark"></ul>
                </div>
                <div class="col-md-4">
                    <div class="card p-3 text-dark">
                        <label for="playerCount" class="form-label">Nombre de joueurs</label>
                        <select id="playerCount" class="form-select mb-3">
                            <option value="8" selected>8 Joueurs</option>
                            <option value="9">9 Joueurs</option>
                            <option value="10">10 Joueurs</option>
                            <option value="11">11 Joueurs</option>
                            <option value="12">12 Joueurs</option>
                            <option value="13">13 Joueurs</option>
                            <option value="14">14 Joueurs</option>
                            <option value="15">15 Joueurs</option>
                            <option value="16">16 Joueurs</option>
                            <option value="17">17 Joueurs</option>
                            <option value="18">18 Joueurs</option>
                        </select>
                        <div id="rolesPreview" class="mb-3 small text-muted"></div>
                        
                        <hr>
                        <div class="form-check form-switch mb-2">
                            <input class="form-check-input" type="checkbox" id="devMode">
                            <label class="form-check-label small" for="devMode">Mode DÃ©veloppeur (Bots rapides)</label>
                        </div>
                        <select id="forceRole" class="form-select form-select-sm mb-3 d-none">
                            <option value="">RÃ´le alÃ©atoire</option>
                            <!-- Rempli par JS -->
                        </select>

                        <button id="btnStart" class="btn btn-success btn-lg">Lancer la partie</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- =================================================================== -->
    <!-- Zone de Jeu -->
    <!-- =================================================================== -->
    <div id="gameArea">
        <div class="row" id="gameBoard">
            <!-- Les cartes des joueurs seront gÃ©nÃ©rÃ©es ici -->
        </div>
        
        <ul id="gameLog" class="list-unstyled mt-4 p-3 bg-dark border rounded" style="height: 150px; overflow-y: scroll;">
            <li class="text-muted small">Journal de la partie...</li>
        </ul>
    </div>

    <!-- =================================================================== -->
    <!-- Interface SorciÃ¨re (CachÃ©e par dÃ©faut) -->
    <!-- =================================================================== -->
    <div id="witchInterface" class="position-fixed bottom-0 start-0 w-100 bg-dark p-3 border-top border-warning" style="display: none; z-index: 1000;">
        <div class="container text-center">
            <h4 class="text-warning">ğŸ§™â€â™€ï¸ Action SorciÃ¨re</h4>
            <p id="witchInfo" class="text-white"></p>
            <div class="d-flex justify-content-center gap-2">
                <button id="btnWitchSave" class="btn btn-success">Sauver la victime</button>
                <button id="btnWitchKill" class="btn btn-danger">Utiliser Potion de Mort</button>
                <button id="btnWitchSkip" class="btn btn-secondary">Ne rien faire</button>
            </div>
            <div id="witchKillSelect" class="mt-2 d-none">
                <p class="text-white">Cliquez sur un joueur pour le tuer.</p>
            </div>
        </div>
    </div>

    <!-- =================================================================== -->
    <!-- Modal de ma carte -->
    <!-- =================================================================== -->
    <div class="modal fade" id="myRoleModal" tabindex="-1" aria-labelledby="myRoleModalTitle" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header">
                    <h5 class="modal-title" id="myRoleModalTitle">Mon RÃ´le</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- <img id="myRoleModalImage" src="" class="img-fluid mb-3"> -->
                    <p id="myRoleModalDescription"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- =================================================================== -->
    <!-- Modal du Voleur -->
    <!-- =================================================================== -->
    <div class="modal fade" id="thiefModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false" aria-labelledby="thiefModalTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header">
                    <h5 class="modal-title" id="thiefModalTitle">ğŸ‘¤ Tour du Voleur</h5>
                </div>
                <div class="modal-body">
                    <p>Vous Ãªtes le Voleur. Voici votre carte actuelle et les deux cartes disponibles. Cliquez sur une carte pour l'Ã©changer ou attendez la fin du temps pour garder la vÃ´tre.</p>
                    <div class="row text-center justify-content-center" id="thiefChoices">
                        <!-- Les cartes du Voleur seront gÃ©nÃ©rÃ©es ici -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- =================================================================== -->
    <!-- Modal des rÃ¨gles -->
    <!-- =================================================================== -->
    <div class="modal fade" id="rulesModal" tabindex="-1" aria-labelledby="rulesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content bg-dark text-white">
                <div class="modal-header">
                    <h5 class="modal-title" id="rulesModalLabel">RÃ¨gles du jeu et RÃ´les</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h5>But du jeu</h5>
                    <p><strong>Pour les Villageois :</strong> Ã‰liminer tous les Loups-Garous.</p>
                    <p><strong>Pour les Loups-Garous :</strong> Ã‰liminer tous les Villageois.</p>
                    <hr>
                    <h5>Les RÃ´les</h5>
                    <dl>
                        <dt>ğŸº Loup-Garou</dt>
                        <dd>Chaque nuit, ils se concertent pour dÃ©vorer un Villageois. Le jour, ils doivent se faire passer pour des innocents.</dd>
                        
                        <dt>ğŸ§‘â€ğŸŒ¾ Simple Villageois</dt>
                        <dd>Il n'a aucune compÃ©tence particuliÃ¨re, mais son vote est crucial pour Ã©liminer les Loups-Garous.</dd>

                        <dt>ğŸ§™â€â™€ï¸ SorciÃ¨re</dt>
                        <dd>Dispose de deux potions uniques : une pour sauver la victime des loups, une pour empoisonner un joueur de son choix durant la nuit.</dd>

                        <dt>ğŸ‘ï¸ Voyante</dt>
                        <dd>Chaque nuit, elle peut espionner un joueur et dÃ©couvrir son vrai rÃ´le. Elle doit aider le village avec discrÃ©tion.</dd>

                        <dt>ğŸ¹ Chasseur</dt>
                        <dd>S'il est Ã©liminÃ© (de n'importe quelle maniÃ¨re), il a le droit d'utiliser sa derniÃ¨re balle pour tuer immÃ©diatement un autre joueur de son choix.</dd>

                        <dt>ğŸ’˜ Cupidon</dt>
                        <dd>La premiÃ¨re nuit, il dÃ©signe deux joueurs qui tombent amoureux. Si l'un meurt, l'autre meurt de chagrin. Si l'un est Loup et l'autre Villageois, leur but devient d'Ã©liminer tous les autres joueurs pour gagner seuls.</dd>

                        <dt>ğŸ‘¤ Le Voleur</dt>
                        <dd>La premiÃ¨re nuit, il peut Ã©changer sa carte avec l'une des deux cartes non distribuÃ©es. S'il y a un Loup-Garou, il peut Ãªtre forcÃ© de le devenir.</dd>

                        <dt>ğŸ‘‘ Capitaine / Maire</dt>
                        <dd>Ã‰lu par les joueurs, son vote compte double. S'il meurt, il dÃ©signe son successeur.</dd>
                    </dl>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fermer</button>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Socket.io & Bootstrap JS -->
<script src="/socket.io/socket.io.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="client.js"></script>
</body>
</html>
